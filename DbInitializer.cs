using System;
using System.Collections.Generic;
using System.Data.SQLite;
using System.IO;
using System.Windows;
using System.Windows.Input;
using static System.Net.Mime.MediaTypeNames;

namespace DataGrid_Pro
{
    public static class DbInitializer
    {
        public static void EnsureDatabase(string dbPath)
        {
            if (Path.GetDirectoryName(dbPath) is string dir)
                Directory.CreateDirectory(dir);

            if (!File.Exists(dbPath))
            {
                SQLiteConnection.CreateFile(dbPath);

                using (var conn = new SQLiteConnection($"Data Source={dbPath};Version=3;"))
                {
                    conn.Open();

                    // ✅ Begin transaction to ensure all statements execute together
                    using (var transaction = conn.BeginTransaction())
                    {
                        var commands = new string[]
                        {
                            
                            @"CREATE TABLE Customers(
    CustomerID INTEGER PRIMARY KEY AUTOINCREMENT,
    CustomerName TEXT NOT NULL,
    CustEmail TEXT
);",

                        @"CREATE TABLE Orders(
                            OrderID INTEGER PRIMARY KEY AUTOINCREMENT,
                            CustomerID INTEGER,
                            OrderDate TEXT,
                            TotalAmount REAL,
                            FOREIGN KEY(CustomerID) REFERENCES Customers(CustomerID)
                        );",

                        @"CREATE TABLE Invoices(
                            InvoiceID INTEGER PRIMARY KEY AUTOINCREMENT,
                            CustomerID INTEGER,
                            InvoiceDate TEXT,
                            TotalDue REAL,
                            FOREIGN KEY(CustomerID) REFERENCES Customers(CustomerID)
                        );",


                        @"CREATE TABLE PurchaseOrders(
                            PurchaseOrderID INTEGER PRIMARY KEY AUTOINCREMENT,
                            SupplierName TEXT,
                            OrderDate TEXT,
                            TotalAmount REAL
                        );",

                        @"CREATE TABLE PurchaseOrderLines(
                            PurchaseOrderLineID INTEGER PRIMARY KEY AUTOINCREMENT,
                            PurchaseOrderID INTEGER,
                            StockItemID INTEGER,
                            ExpectedUnitPricePerOuter REAL,
                            Quantity INTEGER,
                            FOREIGN KEY(PurchaseOrderID) REFERENCES PurchaseOrders(PurchaseOrderID)
                        );",


                        @"CREATE TABLE Colors(
                            ColorID INTEGER PRIMARY KEY AUTOINCREMENT,
                            ColorName TEXT
                        );",

                        @"CREATE TABLE StockItems(
                            StockItemID INTEGER PRIMARY KEY AUTOINCREMENT,
                            StockItemName TEXT,
                            ColorID INTEGER,
                            UnitPrice REAL,
                            FOREIGN KEY(ColorID) REFERENCES Colors(ColorID)
                        );",


                        @"CREATE TABLE Cities(
                            CityID INTEGER PRIMARY KEY AUTOINCREMENT,
                            CityName TEXT,
                            LatestRecordedPopulation INTEGER
                        );",

                        @"CREATE TABLE Countries(
                            CountryID INTEGER PRIMARY KEY AUTOINCREMENT,
                            CountryName TEXT,
                            FormalName TEXT
                        );",


                        @"INSERT INTO Customers(CustomerName, CustEmail)
VALUES
('Acme1 Corp', 'acme1@email.com'),
('Globals M Tradings', 'globalsmtradings@email.com'),
('City 10 Mart', 'city10mart@email.com'),
('Timberland Supplies', 'sales@timberlandsupplies.com'),
('Forest Edge Imports', 'contact@forestedge.com'),
('Urban Build Co', 'info@urbanbuildco.com'),
('EcoHome Designs', 'support@ecohomedesigns.com'),
('Modern Millworks', 'orders@modernmillworks.com'),
('ProWood Industries', 'sales@prowoodind.com'),
('Oak & Pine Interiors', 'team@oakpineinteriors.com'),
('EverGreen Lumber Co', 'info@evergreenlumber.com'),
('Summit Hardware', 'orders@summithardware.com'),
('GreenLeaf Construction', 'contact@greenleafconst.com'),
('Woodland Furniture', 'sales@woodlandfurnishings.com'),
('Pacific Builders Supply', 'service@pacificbuilders.com'),
('TrueForm Design', 'info@trueformdesign.com'),
('Frontier Materials', 'sales@frontiermaterials.com'),
('BlueRiver Trading', 'orders@bluerivertrading.com'),
('Cedar Valley Products', 'contact@cedarvalley.com'),
('NatureLine Furnishings', 'support@natureline.com'),
('Elite Wood Creations', 'sales@elitewood.com'),
('CraftStone Supply', 'info@craftstonesupply.com'),
('PureBuild Construction', 'service@purebuildco.com'),
('LumberMart Wholesale', 'orders@lumbermart.com'),
('GreenPeak Design', 'contact@greenpeakdesign.com'),
('Golden Timber Works', 'sales@goldentimber.com'),
('SolidFrame Manufacturing', 'support@solidframe.com'),
('BuildPro Systems', 'info@buildprosystems.com'),
('CanyonView Construction', 'orders@canyonviewconst.com'),
('UrbanEdge Design', 'team@urbanedge.com'),
('SilverOak Furniture', 'sales@silveroak.com'),
('EcoTimber Products', 'orders@ecotimber.com'),
('MountainView Hardware', 'info@mountainviewhardware.com'),
('Allied Builders Group', 'contact@alliedbuilders.com'),
('SmartBuild Interiors', 'support@smartbuild.com'),
('LumberLine Distributors', 'sales@lumberline.com'),
('WoodHouse Supply', 'orders@woodhousesupply.com'),
('PrimeStone Traders', 'service@primestone.com'),
('ModernCraft Interiors', 'info@moderncraft.com'),
('Redwood Manufacturing', 'sales@redwoodmfg.com'),
('PureEarth Designs', 'contact@pureearthdesigns.com'),
('Highland Woodworks', 'orders@highlandwoodworks.com'),
('BlueSky Construction', 'info@blueskyconst.com'),
('TimberPro Traders', 'sales@timberpro.com'),
('UrbanOak Interiors', 'support@urbanoak.com'),
('NextGen Lumber Co', 'orders@nextgenlumber.com'),
('WoodCore Supplies', 'contact@woodcore.com'),
('EcoLite Manufacturing', 'sales@ecolite.com'),
('NorthernCraft Design', 'info@northerncraft.com'),
('ProBuild Materials', 'service@probuild.com'),
('WoodLogic Enterprises', 'support@woodlogic.com');",

                        @"INSERT INTO Orders(CustomerID, OrderDate, TotalAmount)
VALUES
(1, '2025-09-01', 2500.00),
(2, '2025-09-05', 1800.50),
(3, '2025-09-10', 3200.75),
(4, '2025-09-12', 1450.00),
(5, '2025-09-13', 2750.25),
(6, '2025-09-14', 950.75),
(7, '2025-09-15', 2100.00),
(8, '2025-09-16', 1650.00),
(9, '2025-09-17', 2450.00),
(10, '2025-09-18', 3100.50),
(11, '2025-09-19', 1200.25),
(12, '2025-09-20', 2600.00),
(13, '2025-09-21', 970.00),
(14, '2025-09-22', 1375.25),
(15, '2025-09-23', 1780.75),
(16, '2025-09-24', 2140.00),
(17, '2025-09-25', 985.50),
(18, '2025-09-26', 1900.25),
(19, '2025-09-27', 2300.00),
(20, '2025-09-28', 1400.00),
(21, '2025-09-29', 3050.75),
(22, '2025-09-30', 1295.00),
(23, '2025-10-01', 1015.50),
(24, '2025-10-02', 2590.00),
(25, '2025-10-03', 1820.25),
(26, '2025-10-04', 2950.75),
(27, '2025-10-05', 1685.00),
(28, '2025-10-06', 1340.50),
(29, '2025-10-07', 1595.25),
(30, '2025-10-08', 2390.00),
(31, '2025-10-09', 1945.75),
(32, '2025-10-10', 1640.25),
(33, '2025-10-11', 2895.50),
(34, '2025-10-12', 1110.00),
(35, '2025-10-13', 1715.25),
(36, '2025-10-14', 2370.00),
(37, '2025-10-15', 975.75),
(38, '2025-10-16', 3150.00),
(39, '2025-10-17', 2085.25),
(40, '2025-10-18', 2665.00),
(41, '2025-10-19', 1175.50),
(42, '2025-10-20', 1550.00),
(43, '2025-10-21', 1835.75),
(44, '2025-10-22', 2360.00),
(45, '2025-10-23', 2645.25),
(46, '2025-10-24', 1930.00),
(47, '2025-10-25', 2220.50),
(48, '2025-10-26', 2415.00),
(49, '2025-10-27', 1685.75),
(50, '2025-10-28', 3080.00);",

                        @"INSERT INTO Invoices(CustomerID, InvoiceDate, TotalDue)
VALUES
(1, '2025-09-02', 2500.00),
(2, '2025-09-06', 1800.50),
(3, '2025-09-11', 3200.75),
(4, '2025-09-13', 1450.00),
(5, '2025-09-14', 2675.25),
(6, '2025-09-15', 890.50),
(7, '2025-09-16', 1950.00),
(8, '2025-09-17', 1540.00),
(9, '2025-09-18', 2475.75),
(10, '2025-09-19', 3120.00),
(11, '2025-09-20', 1180.50),
(12, '2025-09-21', 2600.00),
(13, '2025-09-22', 980.25),
(14, '2025-09-23', 1375.00),
(15, '2025-09-24', 1750.75),
(16, '2025-09-25', 2110.00),
(17, '2025-09-26', 970.00),
(18, '2025-09-27', 1890.25),
(19, '2025-09-28', 2300.00),
(20, '2025-09-29', 1420.50),
(21, '2025-09-30', 3050.00),
(22, '2025-10-01', 1285.25),
(23, '2025-10-02', 990.75),
(24, '2025-10-03', 2575.00),
(25, '2025-10-04', 1840.00),
(26, '2025-10-05', 2980.25),
(27, '2025-10-06', 1675.50),
(28, '2025-10-07', 1310.00),
(29, '2025-10-08', 1555.75),
(30, '2025-10-09', 2340.50),
(31, '2025-10-10', 1915.00),
(32, '2025-10-11', 1630.25),
(33, '2025-10-12', 2880.00),
(34, '2025-10-13', 1120.50),
(35, '2025-10-14', 1740.25),
(36, '2025-10-15', 2395.00),
(37, '2025-10-16', 980.75),
(38, '2025-10-17', 3175.00),
(39, '2025-10-18', 2075.25),
(40, '2025-10-19', 2680.00),
(41, '2025-10-20', 1195.50),
(42, '2025-10-21', 1560.25),
(43, '2025-10-22', 1850.00),
(44, '2025-10-23', 2355.50),
(45, '2025-10-24', 2650.00),
(46, '2025-10-25', 1910.75),
(47, '2025-10-26', 2215.00),
(48, '2025-10-27', 2430.25),
(49, '2025-10-28', 1675.00),
(50, '2025-10-29', 3095.50);",

                        @"INSERT INTO PurchaseOrders (SupplierName, OrderDate, TotalAmount)
VALUES
('LumberPro1 Ltd', '2025-09-03', 950.00),
('WoodWorks1 Inc', '2025-09-04', 1250.00),
('ForestEdge Supplies', '2025-09-05', 875.50),
('TimberNation Co', '2025-09-06', 1420.75),
('EverGreen Traders', '2025-09-07', 1110.25),
('Pacific Lumber Group', '2025-09-08', 980.00),
('MapleCraft Mills', '2025-09-09', 1365.40),
('Summit Timberworks', '2025-09-10', 890.00),
('UrbanWood Imports', '2025-09-11', 1235.25),
('NatureCore Lumber', '2025-09-12', 995.00),
('Greenline Supplies', '2025-09-13', 1040.75),
('CedarPeak Trading', '2025-09-14', 1475.60),
('LogiWood Distributors', '2025-09-15', 1300.00),
('NorthStar Timber', '2025-09-16', 970.00),
('EcoPlank Global', '2025-09-17', 1550.00),
('PureGrain Woods', '2025-09-18', 880.00),
('TrueTree Suppliers', '2025-09-19', 1200.75),
('SolidEdge Lumber', '2025-09-20', 1130.00),
('PremiumTimber Co', '2025-09-21', 1460.50),
('Oakline Distributors', '2025-09-22', 1325.25),
('WoodSource Inc', '2025-09-23', 1025.00),
('NatureMill Traders', '2025-09-24', 1395.75),
('Global Forest Co', '2025-09-25', 915.25),
('Precision Lumberworks', '2025-09-26', 1080.00),
('GreenFront Imports', '2025-09-27', 990.75),
('Canyon Timber Supply', '2025-09-28', 1185.00),
('SummitWood Global', '2025-09-29', 1270.00),
('EarthTone Materials', '2025-09-30', 1075.00),
('Woodline Creations', '2025-10-01', 1210.50),
('RiverOak Traders', '2025-10-02', 965.75),
('GoldenTree Mills', '2025-10-03', 1330.00),
('TimberHub Solutions', '2025-10-04', 1415.25),
('EcoFiber Lumber', '2025-10-05', 1120.00),
('CrownWood Trading', '2025-10-06', 1010.25),
('Frontier Timberworks', '2025-10-07', 1545.00),
('Pioneer Woods', '2025-10-08', 1280.75),
('Allied Lumber Corp', '2025-10-09', 1450.00),
('BluePeak Lumber', '2025-10-10', 1375.25),
('Woodland Traders', '2025-10-11', 900.00),
('EverWood Solutions', '2025-10-12', 985.00),
('Summit Sawmill Co', '2025-10-13', 1560.00),
('National Timber Supply', '2025-10-14', 1425.25),
('EcoLogix Lumber', '2025-10-15', 1195.00),
('WoodFlow Distributors', '2025-10-16', 950.50),
('LumberBase Imports', '2025-10-17', 1005.75),
('TreeTop Trading', '2025-10-18', 1380.00),
('Heritage Woods Ltd', '2025-10-19', 1475.25),
('CedarRiver Supplies', '2025-10-20', 1080.50),
('OakStone Lumber', '2025-10-21', 1320.00),
('PinePeak Global', '2025-10-22', 1265.00),
('GreenEarth Traders', '2025-10-23', 1390.25);",

                        @"INSERT INTO Colors(ColorName)
VALUES
('Red'),
('Blue'),
('Green'),
('Yellow'),
('Black'),
('White'),
('Gray'),
('Brown'),
('Beige'),
('Ivory'),
('Orange'),
('Purple'),
('Pink'),
('Cyan'),
('Magenta'),
('Turquoise'),
('Teal'),
('Lavender'),
('Maroon'),
('Navy'),
('Olive'),
('Silver'),
('Gold'),
('Bronze'),
('Coral'),
('Mint'),
('Charcoal'),
('Lilac'),
('Rust'),
('Crimson'),
('Indigo'),
('Sand'),
('Copper'),
('Peach'),
('Azure'),
('Violet'),
('Plum'),
('Khaki'),
('Mustard'),
('Burgundy'),
('Denim'),
('Sky Blue'),
('Forest Green'),
('Emerald'),
('Slate Gray'),
('Seafoam'),
('Amber'),
('Rose'),
('Tan'),
('Pearl'),
('Off-White');",

                        @"INSERT INTO StockItems(StockItemName, ColorID, UnitPrice)
VALUES
('Oak Plank', 1, 45.00),
('Pine Sheet', 2, 30.00),
('Maple Board', 3, 55.00),
('Cedar Panel', 4, 48.75),
('Birch Plywood', 1, 36.50),
('Walnut Slab', 2, 72.00),
('Mahogany Plank', 3, 65.00),
('Teak Board', 4, 80.00),
('Cherry Veneer', 1, 50.25),
('Ash Timber', 2, 42.75),
('Poplar Sheet', 3, 28.50),
('Redwood Panel', 4, 67.00),
('Spruce Board', 1, 33.50),
('Bamboo Sheet', 2, 25.00),
('Larch Timber', 3, 46.75),
('Beech Plank', 4, 39.25),
('Hickory Board', 1, 58.50),
('Sycamore Sheet', 2, 37.25),
('Elm Timber', 3, 53.00),
('Rosewood Slab', 4, 85.00),
('Acacia Panel', 1, 47.25),
('Aspen Board', 2, 32.00),
('Basswood Sheet', 3, 27.50),
('Willow Plank', 4, 31.75),
('Cypress Board', 1, 49.00),
('Olivewood Panel', 2, 78.25),
('Hemlock Timber', 3, 41.50),
('Eucalyptus Board', 4, 44.75),
('Palm Sheet', 1, 26.25),
('Fir Timber', 2, 37.75),
('Sapele Plank', 3, 64.00),
('Padauk Board', 4, 70.50),
('Zebrawood Panel', 1, 88.00),
('Iroko Timber', 2, 59.50),
('Wenge Board', 3, 93.75),
('Ramin Sheet', 4, 38.25),
('Douglas Fir Plank', 1, 52.00),
('Merbau Board', 2, 75.25),
('Pecan Timber', 3, 56.75),
('Balsa Sheet', 4, 21.50),
('Koa Board', 1, 68.25),
('Alder Timber', 2, 35.75),
('Butternut Board', 3, 49.50),
('Ebony Slab', 4, 120.00),
('Lignum Vitae Board', 1, 110.00),
('Ironwood Timber', 2, 105.50),
('Poplar Veneer', 3, 24.25),
('Willow Veneer', 4, 27.00),
('Cherry Timber', 1, 58.00),
('Pine Beam', 2, 32.75),
('Oak Veneer', 3, 46.25);",

                        @"INSERT INTO PurchaseOrderLines(PurchaseOrderID, StockItemID, ExpectedUnitPricePerOuter, Quantity)
VALUES
(1, 1, 45.00, 10),
(1, 2, 30.00, 5),
(2, 3, 55.00, 8),
(2, 1, 42.50, 15),
(3, 4, 29.99, 20),
(3, 5, 31.50, 12),
(4, 2, 33.00, 7),
(4, 3, 52.25, 14),
(5, 6, 60.00, 10),
(5, 1, 47.50, 9),
(6, 2, 34.75, 18),
(6, 3, 53.25, 6),
(7, 4, 28.00, 11),
(7, 5, 35.75, 13),
(8, 6, 59.50, 8),
(8, 7, 40.00, 10),
(9, 8, 36.25, 9),
(9, 9, 32.00, 20),
(10, 10, 44.75, 16),
(10, 11, 38.50, 18),
(11, 12, 41.25, 7),
(11, 13, 45.00, 12),
(12, 14, 48.50, 6),
(12, 15, 50.25, 15),
(13, 16, 43.00, 10),
(13, 17, 39.50, 14),
(14, 18, 42.00, 9),
(14, 19, 37.25, 13),
(15, 20, 49.00, 17),
(15, 21, 52.75, 19),
(16, 22, 46.50, 11),
(16, 23, 44.25, 8),
(17, 24, 55.00, 10),
(17, 25, 58.75, 12),
(18, 26, 61.50, 14),
(18, 27, 48.25, 16),
(19, 28, 51.00, 18),
(19, 29, 53.75, 20),
(20, 30, 56.50, 22),
(20, 31, 59.25, 24),
(21, 32, 62.00, 26),
(21, 33, 64.75, 28),
(22, 34, 67.50, 30),
(22, 35, 70.25, 32),
(23, 36, 73.00, 34),
(23, 37, 75.75, 36),
(24, 38, 78.50, 38),
(24, 39, 81.25, 40),
(25, 40, 84.00, 42),
(25, 41, 86.75, 44),
(25, 42, 89.50, 46);",

                        @"INSERT INTO Cities(CityName, LatestRecordedPopulation)
VALUES
('Los Angeles', 3970000),
('New York', 8419000),
('Chicago', 2716000),
('Houston', 2328000),
('Phoenix', 1690000),
('Philadelphia', 1584000),
('San Antonio', 1547000),
('San Diego', 1424000),
('Dallas', 1356000),
('San Jose', 1035000),
('Austin', 1027000),
('Jacksonville', 962000),
('San Francisco', 873000),
('Columbus', 906000),
('Fort Worth', 918000),
('Indianapolis', 882000),
('Charlotte', 879000),
('Seattle', 737000),
('Denver', 715000),
('Washington', 712000),
('Boston', 684000),
('El Paso', 678000),
('Nashville', 690000),
('Oklahoma City', 655000),
('Las Vegas', 646000),
('Portland', 641000),
('Detroit', 639000),
('Memphis', 628000),
('Louisville', 621000),
('Baltimore', 602000),
('Milwaukee', 577000),
('Albuquerque', 562000),
('Tucson', 542000),
('Fresno', 542000),
('Mesa', 521000),
('Sacramento', 518000),
('Kansas City', 508000),
('Atlanta', 506000),
('Miami', 461000),
('Omaha', 478000),
('Raleigh', 467000),
('Colorado Springs', 472000),
('Virginia Beach', 450000),
('Oakland', 433000),
('Minneapolis', 430000),
('Tulsa', 413000),
('Arlington', 394000),
('New Orleans', 383000),
('Wichita', 397000),
('Tampa', 394000),
('Honolulu', 347000);",

                        @"INSERT INTO Countries(CountryName, FormalName)
VALUES
('United States', 'United States of America'),
('Canada', 'Canada'),
('Australia', 'Commonwealth of Australia'),
('United Kingdom', 'United Kingdom of Great Britain and Northern Ireland'),
('Germany', 'Federal Republic of Germany'),
('France', 'French Republic'),
('Italy', 'Italian Republic'),
('Spain', 'Kingdom of Spain'),
('Portugal', 'Portuguese Republic'),
('Netherlands', 'Kingdom of the Netherlands'),
('Belgium', 'Kingdom of Belgium'),
('Sweden', 'Kingdom of Sweden'),
('Norway', 'Kingdom of Norway'),
('Denmark', 'Kingdom of Denmark'),
('Finland', 'Republic of Finland'),
('Switzerland', 'Swiss Confederation'),
('Austria', 'Republic of Austria'),
('Poland', 'Republic of Poland'),
('Czech Republic', 'Czech Republic'),
('Hungary', 'Hungary'),
('Ireland', 'Republic of Ireland'),
('Greece', 'Hellenic Republic'),
('Turkey', 'Republic of Turkey'),
('Israel', 'State of Israel'),
('United Arab Emirates', 'United Arab Emirates'),
('Saudi Arabia', 'Kingdom of Saudi Arabia'),
('India', 'Republic of India'),
('China', 'People’s Republic of China'),
('Japan', 'Japan'),
('South Korea', 'Republic of Korea'),
('Singapore', 'Republic of Singapore'),
('Malaysia', 'Malaysia'),
('Thailand', 'Kingdom of Thailand'),
('Vietnam', 'Socialist Republic of Vietnam'),
('Indonesia', 'Republic of Indonesia'),
('Philippines', 'Republic of the Philippines'),
('New Zealand', 'New Zealand'),
('South Africa', 'Republic of South Africa'),
('Egypt', 'Arab Republic of Egypt'),
('Kenya', 'Republic of Kenya'),
('Nigeria', 'Federal Republic of Nigeria'),
('Brazil', 'Federative Republic of Brazil'),
('Argentina', 'Argentine Republic'),
('Chile', 'Republic of Chile'),
('Mexico', 'United Mexican States'),
('Colombia', 'Republic of Colombia'),
('Peru', 'Republic of Peru'),
('Panama', 'Republic of Panama'),
('Costa Rica', 'Republic of Costa Rica'),
('Dominican Republic', 'Dominican Republic'),
('Jamaica', 'Jamaica');"
};
                    

                    foreach (string sql in commands)
                        {
                            using (var cmd = new SQLiteCommand(sql, conn))
                                cmd.ExecuteNonQuery();
                        }

                        // ✅ Commit all inserts together
                        transaction.Commit();
                    }
                }

                MessageBox.Show($"Database created and populated successfully at:\n{dbPath}", "Success");
            }
        }
    }
}
